# Workflow Playbook

This playbook provides a systematic approach to building production-ready Mino use cases from start to finish.

## The 5-Phase Workflow

```
Define → Research → Configure → Build → Iterate
```

## Phase 1: Define the Goal

Before writing any code, clearly define what you're trying to accomplish.

### Questions to Answer

1. **What is the end result?**
   - Data extraction? Form submission? Multi-step workflow?
   - What format should the output be in?

2. **What are the inputs?**
   - Fixed URL or dynamic?
   - User-provided data (credentials, search terms)?
   - How many pages/items to process?

3. **What are the constraints?**
   - Rate limits? Time constraints?
   - Geographic restrictions?
   - Authentication requirements?

### Example Definition

```markdown
**Use Case**: Credit Card Comparison Tool
**Goal**: Extract credit card offers from 6 financial sites
**Output**: JSON with card name, APR, annual fee, rewards, signup bonus
**Inputs**: Category filter (travel, cashback, etc.)
**Constraints**: Some sites geo-restricted to US
```

## Phase 2: Research the Target Sites

Before automating, manually explore each target site.

### Site Analysis Checklist

For each target site:

- [ ] **URL Structure**: Is it stable? Does it change with filters/search?
- [ ] **Bot Protection**: Cloudflare? CAPTCHA? Rate limiting?
- [ ] **Content Loading**: Static HTML or JavaScript-rendered?
- [ ] **Pagination**: How does it work? Infinite scroll? Page numbers?
- [ ] **Authentication**: Login required? Cookies needed?
- [ ] **Geographic Restrictions**: US-only? Region-locked content?

### Document Your Findings

```markdown
**Site**: example-bank.com
**URL**: https://example-bank.com/credit-cards
**Protection**: Cloudflare (needs stealth mode)
**Content**: JavaScript-rendered, loads after 2-3 seconds
**Pagination**: "Load More" button, up to 20 cards
**Auth**: Not required
**Geo**: US-only (needs proxy)
```

## Phase 3: Configure the Request

Based on your research, configure the Mino request parameters.

### Browser Profile Decision Tree

```
Site has bot protection?
├─ Yes → Use "stealth"
└─ No → Use "lite" (default)

Getting "Access Denied" or CAPTCHA?
├─ Yes → Switch to "stealth"
└─ No → Keep current profile
```

### Proxy Decision Tree

```
Content is geo-restricted?
├─ Yes → Enable proxy with appropriate country_code
└─ No → No proxy needed

Getting blocked even with stealth?
├─ Yes → Add proxy
└─ No → No proxy needed
```

### Configuration Template

```typescript
const config = {
  url: "https://target-site.com/page",
  goal: "...", // Your goal here

  // Only add if needed:
  browser_profile: "stealth", // For protected sites
  proxy_config: {
    enabled: true,
    country_code: "US", // US, GB, CA, DE, FR, JP, AU
  },
};
```

## Phase 4: Build the Goal

Write your goal using the techniques from [Prompt Templates](/prompt-templates).

### Goal Writing Process

1. **Start Simple**: Extract one piece of data first
2. **Verify It Works**: Run and check output
3. **Add Complexity**: Add more data points
4. **Add Steps**: Add navigation/interaction if needed
5. **Handle Edge Cases**: Add conditionals for popups, loading states

### Progressive Example

**Step 1 - Simple extraction**:
```
Extract the first product name
```

**Step 2 - Add data points**:
```
Extract product name, price, and rating
```

**Step 3 - Multiple items**:
```
Extract product name, price, and rating for all products on this page
```

**Step 4 - Structured output**:
```
For each product on this page, extract:
- name
- price
- rating
- url

Return as JSON array
```

**Step 5 - Handle edge cases**:
```
If a cookie consent popup appears, click "Accept".

For each product on this page, extract:
- name
- price
- rating
- url

Return as JSON array
```

## Phase 5: Iterate and Refine

No automation is perfect on the first try. Here's how to iterate.

### Debugging with streamingUrl

Every Mino response includes a `streamingUrl` that lets you watch the browser in real-time.

```typescript
for (const line of lines) {
  if (line.startsWith("data: ")) {
    const event = JSON.parse(line.slice(6));

    // Log the streaming URL to watch live
    if (event.streamingUrl) {
      console.log("Watch live:", event.streamingUrl);
    }
  }
}
```

### Common Issues and Fixes

| Symptom | Likely Cause | Fix |
|---------|--------------|-----|
| Empty results | Element not found | Watch streamingUrl, adjust goal to match what's visible |
| Timeout | Page loads slowly | Add explicit wait in goal |
| Access denied | Bot detection | Switch to stealth mode |
| Partial data | Pagination not handled | Add pagination to goal |
| Wrong data | Goal ambiguous | Be more specific about which elements |

### Iteration Cycle

```
Run → Observe (via streamingUrl) → Diagnose → Refine → Run
```

1. **Run** the automation
2. **Observe** behavior in streamingUrl
3. **Diagnose** what went wrong
4. **Refine** the goal or configuration
5. **Run** again

### Goal Refinement Patterns

**Original (too vague)**:
```
Get the data from the page
```

**Refined (specific)**:
```
Extract the product table showing name, price, and availability columns
```

**Original (element not found)**:
```
Click the Submit button
```

**Refined (visual description)**:
```
Click the green "Submit" button at the bottom right of the form
```

**Original (timing issue)**:
```
Extract search results
```

**Refined (with wait)**:
```
Wait 3 seconds for results to load, then extract search results
```

## Complete Example: Building a Use Case

### 1. Define

```
Goal: Extract job listings from LinkedIn
Data: Job title, company, location, posting date, URL
Constraint: Need to be logged in, geo-restricted
```

### 2. Research

```
- URL: https://linkedin.com/jobs/search/?keywords=...
- Protection: Heavy bot detection
- Content: Dynamic JavaScript
- Auth: Required
- Geo: Works globally but results vary by region
```

### 3. Configure

```typescript
const config = {
  url: "https://linkedin.com/jobs/search/?keywords=software+engineer",
  browser_profile: "stealth",
  proxy_config: { enabled: true, country_code: "US" },
};
```

### 4. Build

```typescript
const goal = `
1. If login prompt appears, enter email "user@example.com" and password "pass123"
2. Wait for job listings to load
3. For each job listing visible on the page, extract:
   - Job title
   - Company name
   - Location
   - Posting date
   - Job URL
4. Return as JSON array
`;
```

### 5. Iterate

- Watch streamingUrl to verify login works
- Adjust wait times if content loads slowly
- Refine element descriptions if extraction misses items
- Handle any popups or modals that appear
